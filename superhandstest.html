<!DOCTYPE html>
<html>
  <head>
  <title>Most Basic Super-Hands Example</title>
  <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
  <script src="https://unpkg.com/super-hands/dist/super-hands.min.js"></script>
  <script src="https://rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.1.2/dist/aframe-physics-system.min.js"></script>
  <script src="https://unpkg.com/aframe-event-set-component@4.2.1/dist/aframe-event-set-component.min.js"></script>
  <script src="https://unpkg.com/aframe-physics-extras/dist/aframe-physics-extras.min.js"></script>
  <script>
        // turn controller's physics presence on only while button held down
          AFRAME.registerComponent('phase-shift', {
            init: function () {
              var el = this.el
              el.addEventListener('gripdown', function () {
                el.setAttribute('collision-filter', {collisionForces: true})
              })
              el.addEventListener('gripup', function () {
                el.setAttribute('collision-filter', {collisionForces: false})
              })
            }
          })
  </script>
  </head>
  <body>

    <!-- Where I left off: The moveable box now has physics and will not go through the floor. Now I need to figure out how hand-controls crashes the page, but works in the basic test. And Vive controls do not spawn the controllers -->
     <a-scene environment="preset: tron; shadow: true" physics>
      <a-assets>
              <a-mixin id="cube" geometry="primitive: box; width: 0.33; height: 0.33; depth: 0.33"
                       hoverable grabbable stretchable draggable
                       event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
                       event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"
                       dynamic-body shadow></a-mixin>
               <!-- <a-mixin id="transformer" color-randomizer droppable static-body
                       collision-filter="collisionForces: false"
                       event-set__dragon="_event: dragover-start; material.wireframe: true"
                       event-set__dragoff="_event: dragover-end; material.wireframe: false"
                       geometry="primitive: box; width: 0.5; height: 0.5; depth: 0.5"></a-mixin> -->
              <a-mixin id="touch"
                       physics-collider phase-shift
                       collision-filter="collisionForces: false"
                       static-body="shape: sphere; sphereRadius: 0.02"
                       super-hands="colliderEvent: collisions;
                                    colliderEventProperty: els;
                                    colliderEndEvent: collisions;
                                    colliderEndEventProperty: clearedEls;">
              </a-mixin>
      </a-assets>
            <!-- Mixin="touch" has been removed after ID to troubleshoot why controllers are showing and the too much recursion error -->
            <a-entity id="player">
              <a-camera position="0 1.6 0"></a-camera>
              <!-- <a-entity id="rhand"
                        mixin="touch"
                        vive-controls="hand: right"
                        sphere-collider="objects: #moveable_box"
                        super-hands>
              </a-entity>
              <a-entity id="lhand"
                        mixin="touch"
                        vive-controls="hand: left"
                        sphere-collider="objects: #moveable_box"
                        super-hands>
              </a-entity> -->
              <a-entity mixin="touch" sphere-collider="objects: #cube" super-hands hand-controls="left"></a-entity>
              <a-entity mixin="touch" sphere-collider="objects: #cube" super-hands hand-controls="right"></a-entity>
            </a-entity>
    <!-- hover & drag-drop won't have any obvious effect without some additional event handlers or components. See the examples page for more -->
    <a-entity id="moveable_box" mixin="cube" position="0 1 1"></a-entity>

    <!-- ground collider keeps objets from falling -->
    <a-box static-body width=100 height=0.001 depth=100 visible="false"></a-box>

  </a-scene>
</body>
</html>
