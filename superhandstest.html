<!DOCTYPE html>
<html>
  <meta charset="utf-8">
  <head>
  <title>Most Basic Super-Hands Example</title>
  <script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>
  <script src="https://unpkg.com/super-hands/dist/super-hands.min.js"></script>
  <script src="https://rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.1.2/dist/aframe-physics-system.min.js"></script>
  <script src="https://unpkg.com/aframe-event-set-component@4.2.1/dist/aframe-event-set-component.min.js"></script>
  <script src="https://unpkg.com/aframe-physics-extras/dist/aframe-physics-extras.min.js"></script>
  <script src="https://rawgit.com/fernandojsg/aframe-teleport-controls/master/dist/aframe-teleport-controls.min.js"></script>
  <script src="scripts\widgets\dist\aframe-ui-widgets.min.js"></script>
  <script>
        // turn controller's physics presence on only while button held down
          AFRAME.registerComponent('phase-shift', {
            init: function () {
              var el = this.el
              el.addEventListener('gripdown', function () {
                el.setAttribute('collision-filter', {collisionForces: true})
              })
              el.addEventListener('gripup', function () {
                el.setAttribute('collision-filter', {collisionForces: false})
              })
            }
          })
  </script>
  </head>
  <body>

     <a-scene environment="preset: forest; dressing: trees; shadow: true" physics>
      <a-assets>
              <img id="shapeOrigin" src="assets\shapeOrigin.jpg"/>
              <a-mixin id="cube" geometry="primitive: box; width: 0.33; height: 0.33; depth: 0.33"
                       hoverable grabbable stretchable draggable
                       event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
                       event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"
                       dynamic-body shadow></a-mixin>
              <a-mixin id="sphere" geometry="primitive: sphere; scale: .25;"
                       hoverable grabbable stretchable draggable
                       event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
                       event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"
                       dynamic-body shadow></a-mixin>
               <!-- <a-mixin id="transformer" color-randomizer droppable static-body
                       collision-filter="collisionForces: false"
                       event-set__dragon="_event: dragover-start; material.wireframe: true"
                       event-set__dragoff="_event: dragover-end; material.wireframe: false"
                       geometry="primitive: box; width: 0.5; height: 0.5; depth: 0.5"></a-mixin> -->
              <a-mixin id="touch"
                       physics-collider phase-shift
                       collision-filter="collisionForces: false"
                       static-body="shape: sphere; sphereRadius: 0.02"
                       super-hands="colliderEvent: collisions;
                                    colliderEventProperty: els;
                                    colliderEndEvent: collisions;
                                    colliderEndEventProperty: clearedEls;">
              </a-mixin>
      </a-assets>


            <!-- Mixin="touch" has been removed after ID to troubleshoot why controllers are showing and the too much recursion error -->
            <a-entity id="player">
              <a-camera id="head" position="0 1.6 0"></a-camera>
              <a-entity id="lhand" mixin="touch" sphere-collider="objects: #cube, #sphere" hand-controls="left" teleport-controls="cameraRig: #player; teleportOrigin: #head;"></a-entity>
              <a-entity id="rhand" mixin="touch" sphere-collider="objects: #cube, #sphere" hand-controls="right"></a-entity>
           </a-entity>

           <a-entity id="button_area" position="0 -.5 0">
             <a-entity id="table" geometry="height: 3; depth: 0.25" rotation="-90 0 0" position="-3 1 0" scale=".5 .8 .5" material="color: white"></a-entity>
             <a-entity id="button1" ui-button="" position="-3 1.075 1" rotation="0 -90 0" scale="1 1 1" visible="true"></a-entity>
             <a-entity id="button2" ui-button="" position="-3 1.075 0" rotation="0 -90 0" scale="1 1 1" visible="true"></a-entity>
             <a-entity id="button3" ui-button="" position="-3 1.075 -1" rotation="0 -90 0" scale="1 1 1" visible="true"></a-entity>
           </a-entity>
    <!-- hover & drag-drop won't have any obvious effect without some additional event handlers or components. See the examples page for more -->
    <a-entity id="moveable_box" mixin="cube" position="0 1 -1"></a-entity>
    <!-- <a-entity id="moveable_sphere" mixin="sphere" position="0 1 -1" scale=".25 .25 .25"></a-entity> -->
    <!-- <a-entity id="moveable_sphere2" mixin="sphere" position=".7 1 -1" scale=".25 .25 .25"></a-entity> -->

    <a-box id="shapeDropper" position="2 4 1" material="src:#shapeOrigin"></a-box>

    <!-- ground collider keeps objets from falling -->
    <a-box id="solid_ground" static-body width=100 height=0.001 depth=100 visible="false"></a-box>

  </a-scene>

  <script>
      var cubeButton = document.querySelector('#button1');
      cubeButton.addEventListener('pressed', function () {
        var newCube = document.createElement('a-entity');
        newCube.setAttribute('mixin', 'cube');
        newCube.setAttribute('position', {x: 2, y: 4, z: 1});
        this.appendChild(newCube);
        });
  </script>
</body>
</html>
