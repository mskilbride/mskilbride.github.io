<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Forest Test</title>
    <meta name="description" content="Forest Test">
    <script src="https://aframe.io/releases/0.9.0/aframe.min.js"></script>
    <script src="widgets\dist\aframe-ui-widgets.min.js"></script> <!-- Loads buttons, dials and other widgets -->
    <script src="cursor-components\dist\aframe-mouse-cursor-component.min.js"></script>
    <script src="environment\dist\aframe-environment-component.min.js"></script> <!-- Loads predetermined forest background -->
    <script src="extras\dist\aframe-extras.js"></script> <!-- Loads movement contols, mouse controls, and checkpoint system -->
    <script src="physics\dist\aframe-physics-system.js"></script> <!-- Loads physics system *has not worked yet in this scene* -->
  </head>
  <body>
    
     <script>

      //set up these arrays outside the function so that init and tick can both access it
      //use these arrays to hold previous quantities
      rotationArray = []; //use y value
      posArray = [];      //use x value as y value should remain constant

      AFRAME.registerComponent('rotation-reader', {
          init: function () {
              //when the page loads do this
              firstRotation = document.querySelector('#Camera').getAttribute('rotation'); //initial value
              rotationArray.push(Number(firstRotation.y)); //get Number value of y and add to array (if you store the object it'll change)
              firstPos = document.querySelector('#Player').getAttribute('position'); //initial value
              posArray.push(Number(firstPos.x)); //add Number value of x to array (if you do it without Number() it'll change and always = current value
          },
          tick: function () {
              var currentRotation = document.querySelector('#Camera').getAttribute('rotation');
              var currentPos = document.querySelector('#Player').getAttribute('position');
              if (rotationArray[rotationArray.length -1] != Number(currentRotation.y)){
                  //if the camera angle has changed log it in the array this way we keep the array smaller
                  rotationArray.push(Number(currentRotation.y));
                  //and maybe do something else

                  //since there was camera movement check if there has been teleporting
                  if (posArray[posArray.length -1] != Number(currentPos.x)) {
                      //if the person x position has changed lot it in the array
                      posArray.push(Number(currentPos.x));
                      //and maybe try to dynamically set the teleport discs

                  }
              }
              //use this with the chrome console to see what's going on as you move around
              console.log("Current camera y value is:   " + currentRotation.y);
              console.log("Initial camera y value was:  " + rotationArray[0]);
              console.log("Total camera y positions is: " + rotationArray.length);
              console.log("The camera array: " + rotationArray);
              console.log("The current person position: " + document.querySelector('#Player').getAttribute('position').x + ", " + document.querySelector('#Player').getAttribute('position').y + ", " + document.querySelector('#Player').getAttribute('position').z);
              console.log("Total person x positions is: " + posArray.length);
              console.log("The person array: " + posArray);
          }
      });

  </script>
    
    <a-scene>

        <a-assets>
          <a-mixin id="checkpoint"></a-mixin>
          <a-mixin id="checkpoint-hovered" color="#6CEEB5"></a-mixin>
          <a-mixin id="beveled-square" geometry="primitive: cone; radiusTop: 0.15; radiusBottom: 0.19; height: 0.02; segmentsRadial: 4; segmentsHeight: 1" rotation="0 45 0"></a-mixin>
          <a-mixin id="square" geometry="primitive: box; width: 0.18; height: 0.025; depth: 0.18;" position="0 0.02 0"></a-mixin>
          <a-mixin id="blue" material="color: #1E2768;"></a-mixin>
          <a-mixin id="darkgreen" material="color: #22FF90;"></a-mixin>
          <a-mixin id="yellow" material="color: #FFF88E;"></a-mixin>
          <a-mixin id="offset" position="0 0.01 0"></a-mixin>
        </a-assets>

              <!-- Environment -->
        <a-entity environment="preset: forest"></a-entity>
        <!-- <a-grid static-body></a-grid> -->

              <!-- Player -->
            <a-entity id="Player" position="0 1.6 0" movement-controls="controls: checkpoint" checkpoint-controls="mode: animate" rotation="">
                <a-entity rotation-reader></a-entity> 
              <a-entity id="Camera" camera mouse-cursor="" look-controls="pointerLockEnabled: true">
                  <a-entity id="Cursor"
                    cursor="downEvents: ; fuse: false; upEvents: "
                    position="0 0 -1"
                    geometry="primitive:ring;radiusInner:0.02;radiusOuter:0.03"
                    material="color:#CCC;shader:flat"
                    rotation="0 0 0"
                    scale="1 1 1"
                    visible="true"
                    raycaster="">
                  </a-entity>
                </a-entity>
          </a-entity>


              <!-- Checkpoints -->
              <a-entity position="1 0 1" rotation="0 0" scale="1 1 1" visible="true">
                <a-cylinder checkpoint="offset:0 1.6 0" radius="1" height="0.1" position="0 0 -5.2" color="#39BB82"></a-cylinder>
                <a-cylinder checkpoint="offset:0 1.6 0" radius="1" height="0.1" position="3 0 0" color="#39BB82"></a-cylinder>
                <a-cylinder checkpoint="offset:0 1.6 0" radius="1" height="0.1" position="-3 0 0" color="#39BB82"></a-cylinder>
              </a-entity>

              <a-box color="red" position="5.5 0.6 1">
                <a-entity id="mybutton" ui-button="" position="-0.5 .6 -0.016" rotation="45 -89 0" scale="1 1 1" visible="true" cursor-listener=""></a-entity>
              </a-box>

              <!-- <a-entity id="mybutton" ui-button="" position="5.116 1.231 1.028" rotation="45 -89 0" scale="1 1 1" visible="true" cursor-listener="">
                <a-entity geometry="primitive:cylinder;radius:0.1;height:0.025;segmentsHeight:1" position="0 0.02 0" material="color:#960960" rotation="0 0 0" scale="1 1 1" visible="true"></a-entity>
                <a-entity geometry="primitive:cone;radiusTop:0.12;radiusBottom:0.15;height:0.02;segmentsHeight:1" material="color:#618EFF" position="0 0 0" rotation="0 0 0" scale="1 1 1" visible="true"></a-entity>
              </a-entity> -->

    </a-scene>

<!-- Script for button pushing -->
    <script>
    var mybutton = document.querySelector('#mybutton');
    mybutton.addEventListener('pressed', function () {
    // do stuff here.
    });
    </script>

<!-- cursor="downEvents: ; fuse: true; fuseTimeout: 1000; upEvents: " -->
  </body>
</html>
